{% extends "base.html" %}

{% block title %}Meus Quadros Kanban{% endblock %}

{% block extra_css %}
<style>
.board-card {
    transition: all 0.3s ease;
}
.board-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
}
.board-color {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 2px solid #fff;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="flex justify-between items-center mb-8">
        <div>
            <h1 class="text-3xl font-bold text-gray-800">Meus Quadros Kanban</h1>
            <p class="text-gray-600 mt-2">Organize suas tarefas de forma visual e eficiente</p>
        </div>
        <a href="/kanban/boards/new" class="btn btn-primary gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            Novo Quadro
        </a>
    </div>

    <!-- Flash Messages -->
    {% include "parts/flash_message.html" %}

    <!-- Boards Grid -->
    {% if boards %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        {% for board in boards %}
        <div class="board-card card bg-white shadow-lg hover:shadow-xl border-0">
            <div class="card-body p-6">
                <!-- Board Header -->
                <div class="flex items-start justify-between mb-4">
                    <div class="flex items-center gap-3">
                        <div class="board-color" style="background-color: {{ board.color or '#3B82F6' }}"></div>
                        <h3 class="font-bold text-lg text-gray-800 line-clamp-1">{{ board.title }}</h3>
                    </div>
                    <div class="dropdown dropdown-end">
                        <label tabindex="0" class="btn btn-ghost btn-xs btn-circle">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01"></path>
                            </svg>
                        </label>
                        <ul tabindex="0" class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52">
                            <li><a href="/kanban/boards/{{ board.id }}/edit">Editar</a></li>
                            <li><a href="#" onclick="deleteBoard({{ board.id }})" class="text-error">Excluir</a></li>
                        </ul>
                    </div>
                </div>

                <!-- Board Description -->
                {% if board.description %}
                <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ board.description }}</p>
                {% endif %}

                <!-- Board Stats -->
                <div class="flex items-center justify-between text-xs text-gray-500 mb-4">
                    <span>Criado em {{ board.created_at|datetime("%d/%m/%Y") }}</span>
                    {% if board.updated_at != board.created_at %}
                    <span>Atualizado em {{ board.updated_at|datetime("%d/%m/%Y") }}</span>
                    {% endif %}
                </div>

                <!-- Action Button -->
                <div class="card-actions justify-end">
                    <a href="/kanban/boards/{{ board.id }}" class="btn btn-primary btn-sm">
                        Abrir Quadro
                        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <!-- Empty State -->
    <div class="text-center py-16">
        <div class="max-w-md mx-auto">
            <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>
            <h3 class="text-xl font-semibold text-gray-700 mb-2">Nenhum quadro encontrado</h3>
            <p class="text-gray-500 mb-4">Crie seu primeiro quadro Kanban para começar a organizar suas tarefas</p>
            <a href="/kanban/boards/new" class="btn btn-primary">
                Criar Primeiro Quadro
            </a>
        </div>
    </div>
    {% endif %}
</div>

<script>
function deleteBoard(boardId) {
    if (confirm('Tem certeza que deseja excluir este quadro? Esta ação não pode ser desfeita.')) {
        // TODO: Implementar exclusão via API
        fetch(`/kanban/api/boards/${boardId}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                location.reload();
            } else {
                alert('Erro ao excluir quadro: ' + data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Erro ao excluir quadro');
        });
    }
}
</script>
{% endblock %}